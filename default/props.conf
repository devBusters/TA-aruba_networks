#
# TA_aruba-networks
# props.conf
#

[aruba]
pulldown_type = true
TRANSFORMS-sourcetypes = aruba

[aruba:authmgr]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-action = action=(?<action>[^\,]*)
#EXTRACT-src = from (?<src_ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3})\:(?<src_port>[\d]{1,5})
EXTRACT-src = srcip=(?<src_ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3})\s+srcport=(?<src_port>[\d]{1,5})
EXTRACT-dest = dstip=(?<dest_ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3})\s+dstport=(?<dest_port>[\d]{1,5})
EXTRACT-role = role=(?<role>[^\,\s]*)
EXTRACT-policy = policy=(?<policy>[^\,]*)
EXTRACT-essid = essid=(?<essid>[^\s\,]*)
#EXTRACT-user = user=(?<user>[^\,]*)
EXTRACT-user = user(?:name)?=(?<user>[^\,\s]*)

EXTRACT-mac = MAC=(?<mac>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))
EXTRACT-ip = IP=(?<ip>(?:[0-9]{1,3}[\.]){3}(?:[0-9]{1,3}))
EXTRACT-vlan = VLAN=(?<vlan>[^\,\s]*)
EXTRACT-dvc = AP=(?<dvc>[^\s]*)
EXTRACT-ssid = SSID=(?<ssid>[^\s]*)

#username=mf14 AP=AP-Prata-07 SSID=WFH-N AAA profile=AT-aaa-dot1x-guest auth method=802.1x auth server=Internal





LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:cfgm]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:stm]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:localdb]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-user = User (?<user>[^\s]*) guest (?<vendor_action>[^\s]*) (?<protocol>[^\s]*) Authenticated
EVAL-user = lower(user)
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description



[aruba:mdns]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
# TO REVIEW
EXTRACT-mac = MAC:(?<mac>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))
EXTRACT-ip = IP:(?<ip>(?:[0-9]{1,3}[\.]){3}(?:[0-9]{1,3}))
EXTRACT-vlan = VLAN:(?<vlan>[^\,]*)
EXTRACT-role = Role:(?<role>[^\s]*)
#Name:EXPO 
#APName:AP-DFLX-02 
#Type:1. 
#Groups: 

LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description



[aruba:wms]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:isakmpd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-dest = for peer (?<ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3})(?:\:(?<port>[\d]{1,5}))?
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:dbsync]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:sapd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
LOOKUP-aruba_actions = aruba_actions vendor_action OUTPUTNEW action
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:aaa]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-action = Authentication\s+(?<vendor_action>[^\s]*)\s+for
EXTRACT-user = User\s+(?:(?<src_nt_domain>[\w]*)\\)?(?<user>[^\,]*)
EXTRACT-source = Logged in from (?<src_ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3}) port (?<src_port>[\d]{1,5})
EXTRACT-destination = Connecting to (?<dest_ip>[\d\.]*) port (?<dest_port>[\d]*)
EXTRACT-protocol = connection type (?<protocol>[^\r\n]*)
EVAL-dest = coalesce(dest_host,dest_ip,dest_nt_host)
EVAL-src = coalesce(src_host,src_ip,src_nt_host)
EVAL-user = lower(user)
LOOKUP-aruba_actions = aruba_actions vendor_action OUTPUTNEW action
LOOKUP-aruba_severities = aruba_severities vendor_severity OUTPUTNEW severity
LOOKUP-aruba_events = aruba_events event_number OUTPUTNEW event_description

[aruba:rsyncd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>


[aruba:sshd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
