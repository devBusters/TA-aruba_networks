#
# TA-aruba_networks
# props.conf
#

[(?::){0}aruba*]
KV_MODE = none

REPORT-basefields = aruba_basefields, aruba_log_level

LOOKUP-aruba_actions = aruba_actions vendor_action OUTPUTNEW action
LOOKUP-aruba_severities = aruba_log_level vendor_log_level OUTPUTNEW log_level
LOOKUP-aruba_events = aruba_events event_id OUTPUTNEW event_description

[aruba]
KV_MODE = none

REPORT-basefields = aruba_basefields
REPORT-authmgrfields = aruba_traffic, aruba_action, aruba_role, aruba_policy


#
# Default sourcetype for sourcetype renaming
#
[aruba:syslog]
pulldown_type = true

TRANSFORMS-sourcetypes = aruba_sourcetype_renaming












[aruba:authmgr]
pulldown_type = false

REPORT-authmgrfields = aruba_traffic, aruba_action, aruba_role, aruba_policy









EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-action = (?:action)(?:[=])(?<action>[^\,]*)

EXTRACT-role = (?:role)(?:[=])(?<role>[^\,\s]*)
EXTRACT-policy = policy=(?<policy>[^\,]*)
EXTRACT-user = user(?:name)?=(?<user>[^\,\s]*)

EXTRACT-srcmac = (?:MAC|mac|usermac)(?:[=\s:\(]+)(?<src_mac>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))
EXTRACT-srcip = (?:IP|ip|ipuser|ipv4|userip)(?:[=\s])(?<src_ip>(?:[0-9]{1,3}[\.]){3}(?:[0-9]{1,3}))
EXTRACT-apname = (?:apname)(?:[=])(?<ap_name>[^\s]*)
EXTRACT-essid = (?:ESSID|essid)(?:[=\s])(?<essid>[^\s\,]*)
EXTRACT-bssid = (?:BSSID|BSS|bssid)(?:[:=\s])(?<bssid>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))
EXTRACT-vlan = (?:VLAN|vlan)(?:[:=\s])(?<vlan>[^\,\s]*)
EXTRACT-dvcname = AP=(?<dvc_name>[^\s]*)


[aruba:cfgm]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>

EXTRACT-vlan = (?:VLAN|vlan)(?:[:=\s])(?<vlan>[^\,\s]*)


[aruba:stm]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>


[aruba:localdb]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-user = User (?<user>[^\s]*) guest (?<vendor_action>[^\s]*) (?<protocol>[^\s]*) Authenticated
EVAL-user = lower(user)


[aruba:mdns]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>

EXTRACT-srcmac = (?:MAC|mac|usermac)(?:[=\s:\(])(?<src_mac>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))

EXTRACT-ip = IP:(?<ip>(?:[0-9]{1,3}[\.]){3}(?:[0-9]{1,3}))
EXTRACT-vlan = (?:VLAN|vlan)(?:[:=\s])(?<vlan>[^\,\s]*)
EXTRACT-role = (?:Role)(?:[:])(?<role>[^\s]*)


EXTRACT-vlan = (?:VLAN|vlan)(?:[:=\s])(?<vlan>[^\,\s]*)


[aruba:wms]
pulldown_type = false
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>

EXTRACT-bssid = (?:BSSID|bssid)(?:[=\s])(?<bssid>(?:[0-9A-Fa-f]{2}[:]){5}(?:[0-9A-Fa-f]{2}))

[aruba:isakmpd]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-dest = for peer (?<ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3})(?:\:(?<port>[\d]{1,5}))?

[aruba:dbsync]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>

[aruba:sapd]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>



[aruba:aaa]
pulldown_type = false

EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
EXTRACT-action = Authentication\s+(?<vendor_action>[^\s]*)\s+for
EXTRACT-user = User\s+(?:(?<src_nt_domain>[\w]*)\\)?(?<user>[^\,]*)
EXTRACT-source = Logged in from (?<src_ip>(?:[0-9]{1,3}\.){3}[0-9]{1,3}) port (?<src_port>[\d]{1,5})
EXTRACT-destination = Connecting to (?<dest_ip>[\d\.]*) port (?<dest_port>[\d]*)
EXTRACT-protocol = connection type (?<protocol>[^\r\n]*)
EVAL-dest = coalesce(dest_host,dest_ip,dest_nt_host)
EVAL-src = coalesce(src_host,src_ip,src_nt_host)
EVAL-user = lower(user)


[aruba:rsyncd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>


[aruba:sshd]
pulldown_type = false
KV_MODE = none
EXTRACT-info = \[(?<pid>[^\]]*)\]\:\s+\<(?<event_number>[^\>]*)\>\s+\<(?<vendor_severity>[^\>]*)\>
